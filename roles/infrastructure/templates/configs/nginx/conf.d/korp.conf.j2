{% if reverse_proxy.external %}
server {
    listen {{ reverse_proxy.http_ports.frontend }};

    include /etc/nginx/default_conf;

    include /etc/nginx/conf.d/korp.locations;
}
{% endif %}

server {
    server_name {{ dns.frontend }};

    include /etc/nginx/ssl_conf;
    include /etc/nginx/default_conf;

    include /etc/nginx/conf.d/korp.ssl-locations;
}

upstream fabio_upstream {
    server fabio:9999;
    keepalive 64;
}

upstream Viasoft.Loader_upstream {
    server Viasoft.Loader:80;
    keepalive 64;
}
